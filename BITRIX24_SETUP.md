# Настройка Bitrix24 OAuth

## Переменные окружения

Добавьте следующие переменные в ваш файл `.env`:

```env
# Bitrix24 OAuth Credentials
# Получите эти данные при создании локального приложения в вашем портале Битрикс24
BITRIX24_CLIENT_ID=your_client_id_here
BITRIX24_CLIENT_SECRET=your_client_secret_here
```

## Инструкция по получению Client ID и Client Secret

1. Войдите в ваш тестовый портал Битрикс24
2. Перейдите в раздел **Разработчикам** → **Другое** → **Локальное приложение**
3. Нажмите **Создать локальное приложение**
4. Заполните форму:
   - **Название**: Ваше название приложения
   - **URL установки**: `http://your-domain.com/install`
   - **URL обратного вызова**: `http://your-domain.com/auth/callback`
5. Сохраните приложение
6. Скопируйте полученные `Client ID` и `Client Secret` в файл `.env`

## Тестирование установки

После настройки переменных окружения:

1. Перейдите по ссылке установки приложения в вашем портале Битрикс24
2. Приложение должно перенаправить вас на страницу авторизации
3. После предоставления разрешений вы будете перенаправлены на `/auth/callback`
4. Токены будут сохранены в таблице `portals`
5. Вы будете перенаправлены на главную страницу приложения

## Проверка в базе данных

После успешной установки в таблице `portals` должна появиться запись с полями:
- `member_id` - уникальный идентификатор портала
- `domain` - домен портала (например, `your-portal.bitrix24.ru`)
- `access_token` - токен доступа
- `refresh_token` - токен обновления
- `expires_at` - время истечения токена

## Маршруты

Приложение использует следующие маршруты:
- `GET /install` - первоначальная установка приложения
- `GET /auth/callback` - обработка callback от Битрикс24

